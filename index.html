<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FC Barcelona Official Lineup</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;600;800&display=swap');
    
    :root{
      --bg-dark:rgba(0,0,0,0.75);
      --accent:#a50044;
      --gold:#ffd700;
      --text:#fff;
      --blue:#004d98;
    }
    
    *{margin:0;padding:0;box-sizing:border-box}
    
    html,body{
      height:100%;
      font-family:'Inter', system-ui, Arial, sans-serif;
      background:#000;
      overflow-x:hidden;
    }
    
    .stage{
      position:relative;
      min-height:100vh;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* Enhanced background with parallax effect */
    .bg{
      position:absolute;
      inset:-10%;
      background-image:url('assets/campnou.png');
      background-size:cover;
      background-position:center;
      filter:blur(8px) saturate(1.1) brightness(0.5);
      transform:scale(1.1);
      will-change:transform;
      animation:parallaxPan 30s ease-in-out infinite;
    }
    
    @keyframes parallaxPan{
      0%{transform:scale(1.1) translate(0, 0)}
      25%{transform:scale(1.12) translate(-1%, -1%)}
      50%{transform:scale(1.13) translate(-2%, 0)}
      75%{transform:scale(1.12) translate(-1%, 1%)}
      100%{transform:scale(1.1) translate(0, 0)}
    }

    /* Dramatic gradient overlay */
    .overlay{
      position:absolute;
      inset:0;
      background:
        radial-gradient(ellipse at top, rgba(165,0,68,0.15), transparent 60%),
        radial-gradient(ellipse at bottom, rgba(0,77,152,0.2), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.3), rgba(0,0,0,0.8));
      pointer-events:none;
    }
    
    /* Animated particles */
    .particles{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    
    .particle{
      position:absolute;
      width:3px;
      height:3px;
      background:rgba(255,255,255,0.6);
      border-radius:50%;
      animation:float 8s infinite ease-in-out;
    }
    
    @keyframes float{
      0%, 100%{transform:translateY(0) translateX(0);opacity:0}
      10%{opacity:1}
      90%{opacity:1}
      100%{transform:translateY(-100vh) translateX(20px);opacity:0}
    }

    /* Center content */
    .center{
      position:relative;
      z-index:3;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      width:100%;
      height:100vh;
      padding:40px 20px;
    }

    /* Header with logo */
    .header{
      position:absolute;
      top:40px;
      left:50%;
      transform:translateX(-50%);
      z-index:10;
      display:flex;
      align-items:center;
      gap:24px;
      opacity:0;
      transition:opacity 0.8s ease;
    }
    
    .header.show{
      opacity:1;
    }
    
    .header img{
      width:80px;
      height:80px;
      object-fit:contain;
      filter:drop-shadow(0 4px 20px rgba(165,0,68,0.6));
    }
    
    .header .title{
      font-family:'Bebas Neue', sans-serif;
      font-size:36px;
      letter-spacing:3px;
      color:var(--text);
      text-shadow:0 4px 20px rgba(0,0,0,0.8);
      background:linear-gradient(135deg, #fff 0%, #e0e0e0 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    /* Typewriter text */
    .typewriter-container{
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:200px;
      opacity:0;
      transition:opacity 0.6s ease;
    }
    
    .typewriter-container.show{
      opacity:1;
    }
    
    .typewriter{
      font-family:'Bebas Neue', sans-serif;
      font-size:72px;
      letter-spacing:4px;
      color:var(--text);
      text-align:center;
      text-shadow:
        0 0 40px rgba(165,0,68,0.8),
        0 4px 20px rgba(0,0,0,0.9);
      background:linear-gradient(135deg, var(--accent) 0%, #d4145a 50%, var(--accent) 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      background-size:200% auto;
      animation:shimmer 3s ease-in-out infinite;
      border-right:4px solid var(--accent);
      padding-right:8px;
      white-space:nowrap;
      overflow:hidden;
    }
    
    @keyframes shimmer{
      0%, 100%{background-position:0% 50%}
      50%{background-position:100% 50%}
    }
    
    @keyframes blink{
      0%, 100%{border-color:var(--accent)}
      50%{border-color:transparent}
    }

    /* Enhanced intro screen */
    .intro-screen{
      position:relative;
      width:100%;
      height:620px;
      max-width:960px;
      border-radius:24px;
      overflow:hidden;
      display:none;
      align-items:center;
      justify-content:center;
      background:
        linear-gradient(135deg, rgba(165,0,68,0.15), rgba(0,77,152,0.15)),
        rgba(0,0,0,0.5);
      backdrop-filter:blur(20px) saturate(1.2);
      border:1px solid rgba(255,255,255,0.1);
      box-shadow:
        0 0 80px rgba(165,0,68,0.3),
        0 30px 80px rgba(0,0,0,0.9),
        inset 0 1px 0 rgba(255,255,255,0.1);
    }
    
    .intro-screen.show{
      display:flex;
    }
    
    /* Glowing corner accents */
    .intro-screen::before,
    .intro-screen::after{
      content:'';
      position:absolute;
      width:200px;
      height:200px;
      border-radius:50%;
      filter:blur(60px);
      opacity:0.4;
      pointer-events:none;
    }
    
    .intro-screen::before{
      top:-100px;
      left:-100px;
      background:var(--accent);
    }
    
    .intro-screen::after{
      bottom:-100px;
      right:-100px;
      background:var(--blue);
    }

    /* Formation image */
    .formation-img{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    
    .formation-img img{
      max-width:75%;
      height:auto;
      opacity:0;
      transform:scale(0.95);
      transition:opacity 1s ease, transform 1s cubic-bezier(.2,.9,.3,1);
      filter:drop-shadow(0 10px 30px rgba(0,0,0,0.8));
    }
    
    .formation-img.show img{
      opacity:1;
      transform:scale(1);
    }

    /* Premium player card */
    .card{
      position:absolute;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:20px;
      transform:translateY(40px) scale(0.95);
      opacity:0;
      transition:
        transform 0.8s cubic-bezier(.2,.9,.3,1),
        opacity 0.6s ease;
    }
    
    .card.show{
      transform:translateY(0) scale(1);
      opacity:1;
    }
    
    .card .img{
      width:360px;
      height:480px;
      border-radius:20px;
      overflow:hidden;
      position:relative;
      box-shadow:
        0 0 60px rgba(165,0,68,0.4),
        0 30px 80px rgba(0,0,0,0.9);
      border:2px solid rgba(255,255,255,0.15);
    }
    
    .card img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    
    /* Premium shine effect */
    .card .img::after{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        linear-gradient(
          135deg,
          rgba(255,255,255,0) 0%,
          rgba(255,255,255,0.15) 45%,
          rgba(255,255,255,0.25) 50%,
          rgba(255,255,255,0.15) 55%,
          rgba(255,255,255,0) 100%
        );
      transform:translateX(-150%) translateY(-150%) rotate(10deg);
      transition:transform 1.4s cubic-bezier(.2,.9,.3,1);
    }
    
    .card.show .img::after{
      transform:translateX(150%) translateY(150%) rotate(10deg);
    }

    /* Enhanced metadata */
    .meta{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      color:var(--text);
      text-align:center;
      text-shadow:0 4px 12px rgba(0,0,0,0.8);
    }
    
    .meta .name{
      font-family:'Bebas Neue', sans-serif;
      font-size:36px;
      font-weight:400;
      letter-spacing:2px;
      background:linear-gradient(135deg, #fff 0%, #e0e0e0 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }
    
    .meta .pos{
      font-size:16px;
      font-weight:600;
      opacity:0.9;
      letter-spacing:1.5px;
      text-transform:uppercase;
      color:rgba(255,255,255,0.85);
    }

    /* Captain golden aura */
    .captain .img{
      box-shadow:
        0 0 80px rgba(255,215,0,0.5),
        0 30px 80px rgba(0,0,0,0.9);
      border:3px solid rgba(255,215,0,0.4);
      animation:captainGlow 2s ease-in-out infinite;
    }
    
    @keyframes captainGlow{
      0%, 100%{
        box-shadow:
          0 0 80px rgba(255,215,0,0.5),
          0 30px 80px rgba(0,0,0,0.9);
      }
      50%{
        box-shadow:
          0 0 100px rgba(255,215,0,0.7),
          0 30px 80px rgba(0,0,0,0.9);
      }
    }
    
    .captain .meta .name{
      background:linear-gradient(135deg, var(--gold) 0%, #ffed4e 50%, var(--gold) 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    /* Navigation controls */
    .nav-controls{
      position:absolute;
      bottom:40px;
      left:50%;
      transform:translateX(-50%);
      z-index:10;
      display:none;
      gap:16px;
      align-items:center;
    }
    
    .nav-controls.show{
      display:flex;
    }
    
    .nav-btn{
      width:56px;
      height:56px;
      border-radius:50%;
      border:2px solid rgba(255,255,255,0.2);
      background:rgba(0,0,0,0.7);
      backdrop-filter:blur(10px);
      color:#fff;
      font-size:24px;
      cursor:pointer;
      transition:all 0.3s ease;
      box-shadow:0 4px 12px rgba(0,0,0,0.6);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    
    .nav-btn:hover{
      background:rgba(165,0,68,0.8);
      border-color:rgba(165,0,68,0.6);
      transform:scale(1.1);
      box-shadow:0 6px 20px rgba(165,0,68,0.5);
    }
    
    .nav-btn:active{
      transform:scale(0.95);
    }
    
    .nav-btn:disabled{
      opacity:0.3;
      cursor:not-allowed;
    }
    
    .nav-btn:disabled:hover{
      background:rgba(0,0,0,0.7);
      border-color:rgba(255,255,255,0.2);
      transform:scale(1);
      box-shadow:0 4px 12px rgba(0,0,0,0.6);
    }
    
    .play-pause{
      width:72px;
      height:72px;
      font-size:32px;
      background:linear-gradient(135deg, var(--accent) 0%, #d4145a 100%);
      border:none;
      box-shadow:
        0 0 40px rgba(165,0,68,0.6),
        0 8px 24px rgba(0,0,0,0.8);
    }
    
    .play-pause:hover{
      box-shadow:
        0 0 60px rgba(165,0,68,0.9),
        0 12px 32px rgba(0,0,0,0.9);
    }

    /* Rewatch button */
    .rewatch-btn{
      appearance:none;
      border:none;
      background:linear-gradient(135deg, var(--accent) 0%, #d4145a 100%);
      color:var(--text);
      font-family:'Bebas Neue', sans-serif;
      font-size:52px;
      letter-spacing:3px;
      padding:28px 72px;
      border-radius:16px;
      cursor:pointer;
      box-shadow:
        0 0 40px rgba(165,0,68,0.6),
        0 20px 60px rgba(0,0,0,0.8),
        inset 0 1px 0 rgba(255,255,255,0.2);
      opacity:0;
      transform:scale(0.9) translateY(20px);
      transition:all 0.3s ease;
      position:relative;
      overflow:hidden;
      display:none;
    }
    
    .rewatch-btn.show{
      display:block;
      animation:btnEntrance 1.2s cubic-bezier(.2,.9,.3,1) forwards;
    }
    
    .rewatch-btn::before{
      content:'';
      position:absolute;
      inset:0;
      background:linear-gradient(135deg, transparent, rgba(255,255,255,0.1), transparent);
      transform:translateX(-100%);
      transition:transform 0.6s;
    }
    
    .rewatch-btn:hover{
      transform:scale(1.05) translateY(-4px);
      box-shadow:
        0 0 60px rgba(165,0,68,0.9),
        0 25px 70px rgba(0,0,0,0.9),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    
    .rewatch-btn:hover::before{
      transform:translateX(100%);
    }
    
    .rewatch-btn:active{
      transform:scale(0.98) translateY(-2px);
    }
    
    @keyframes btnEntrance{
      to{opacity:1;transform:scale(1) translateY(0)}
    }

    /* Responsive design for all devices */
    
    /* Large tablets and small desktops (1024px - 1200px) */
    @media(max-width:1200px){
      .intro-screen{
        max-width:860px;
        height:580px;
      }
      .card .img{width:340px;height:460px}
      .meta .name{font-size:34px}
      .typewriter{font-size:64px}
    }
    
    /* Tablets landscape (768px - 1024px) */
    @media(max-width:1024px){
      .header{top:30px;gap:20px}
      .header img{width:70px;height:70px}
      .header .title{font-size:30px;letter-spacing:2px}
      
      .typewriter{font-size:56px;letter-spacing:3px}
      
      .intro-screen{
        max-width:760px;
        height:540px;
      }
      
      .card .img{width:300px;height:400px}
      .meta .name{font-size:32px}
      .meta .pos{font-size:15px}
      
      .rewatch-btn{font-size:44px;padding:24px 60px}
      
      .nav-btn{width:52px;height:52px;font-size:22px}
      .play-pause{width:68px;height:68px;font-size:30px}
      .nav-controls{bottom:35px}
    }
    
    /* Tablets portrait (600px - 768px) */
    @media(max-width:768px){
      .header{top:25px;gap:16px}
      .header img{width:60px;height:60px}
      .header .title{font-size:24px;letter-spacing:2px}
      
      .typewriter{font-size:48px;letter-spacing:2px}
      .typewriter-container{min-height:150px}
      
      .intro-screen{
        max-width:90%;
        height:500px;
        border-radius:20px;
      }
      
      .card .img{width:280px;height:380px;border-radius:16px}
      .card{gap:16px}
      .meta .name{font-size:28px;letter-spacing:1.5px}
      .meta .pos{font-size:14px;letter-spacing:1px}
      
      .rewatch-btn{font-size:40px;padding:22px 52px;border-radius:14px}
      
      .nav-btn{width:48px;height:48px;font-size:20px}
      .play-pause{width:64px;height:64px;font-size:28px}
      .nav-controls{bottom:30px;gap:14px}
    }
    
    /* Large phones (480px - 600px) */
    @media(max-width:600px){
      .center{padding:30px 16px}
      
      .header{top:20px;gap:12px;flex-direction:column}
      .header img{width:55px;height:55px}
      .header .title{font-size:20px;letter-spacing:1.5px}
      
      .typewriter{font-size:40px;letter-spacing:2px;padding-right:6px}
      .typewriter-container{min-height:120px}
      
      .intro-screen{
        max-width:95%;
        height:460px;
        border-radius:18px;
      }
      
      .card .img{width:260px;height:350px;border-radius:14px}
      .card{gap:14px}
      .meta .name{font-size:26px;letter-spacing:1px}
      .meta .pos{font-size:13px}
      
      .rewatch-btn{font-size:36px;padding:20px 44px;letter-spacing:2px}
      
      .nav-btn{width:44px;height:44px;font-size:18px}
      .play-pause{width:60px;height:60px;font-size:26px}
      .nav-controls{bottom:25px;gap:12px}
    }
    
    /* Standard phones (375px - 480px) */
    @media(max-width:480px){
      .center{padding:25px 12px}
      
      .header{top:15px;gap:10px}
      .header img{width:50px;height:50px}
      .header .title{font-size:18px;letter-spacing:1px}
      
      .typewriter{
        font-size:32px;
        letter-spacing:1.5px;
        padding-right:5px;
        border-right-width:3px;
      }
      .typewriter-container{min-height:100px}
      
      .intro-screen{
        max-width:96%;
        height:420px;
        border-radius:16px;
      }
      
      .card .img{width:240px;height:320px;border-radius:12px}
      .card{gap:12px}
      .meta .name{font-size:24px}
      .meta .pos{font-size:12px;letter-spacing:0.8px}
      
      .rewatch-btn{
        font-size:32px;
        padding:18px 36px;
        letter-spacing:2px;
        border-radius:12px;
      }
      
      .nav-btn{
        width:42px;
        height:42px;
        font-size:16px;
        border-width:1.5px;
      }
      .play-pause{width:56px;height:56px;font-size:24px}
      .nav-controls{bottom:20px;gap:10px}
    }
    
    /* Small phones (320px - 375px) */
    @media(max-width:375px){
      .center{padding:20px 10px}
      
      .header{top:12px;gap:8px}
      .header img{width:45px;height:45px}
      .header .title{font-size:16px;letter-spacing:0.8px}
      
      .typewriter{
        font-size:28px;
        letter-spacing:1px;
        padding-right:4px;
        border-right-width:2px;
      }
      .typewriter-container{min-height:90px}
      
      .intro-screen{
        max-width:98%;
        height:380px;
        border-radius:14px;
      }
      
      .card .img{width:220px;height:290px;border-radius:10px}
      .card{gap:10px}
      .meta .name{font-size:22px;letter-spacing:0.8px}
      .meta .pos{font-size:11px}
      
      .rewatch-btn{
        font-size:28px;
        padding:16px 32px;
        letter-spacing:1.5px;
        border-radius:10px;
      }
      
      .nav-btn{
        width:38px;
        height:38px;
        font-size:14px;
      }
      .play-pause{width:52px;height:52px;font-size:22px}
      .nav-controls{bottom:16px;gap:8px}
    }
    
    /* Extra small phones (below 320px) */
    @media(max-width:320px){
      .center{padding:16px 8px}
      
      .header{top:10px;gap:6px}
      .header img{width:40px;height:40px}
      .header .title{font-size:14px;letter-spacing:0.5px}
      
      .typewriter{
        font-size:24px;
        letter-spacing:0.8px;
        padding-right:3px;
        border-right-width:2px;
      }
      .typewriter-container{min-height:80px}
      
      .intro-screen{
        max-width:98%;
        height:350px;
        border-radius:12px;
      }
      
      .card .img{width:200px;height:270px;border-radius:10px}
      .card{gap:8px}
      .meta .name{font-size:20px;letter-spacing:0.5px}
      .meta .pos{font-size:10px;letter-spacing:0.5px}
      
      .rewatch-btn{
        font-size:24px;
        padding:14px 28px;
        letter-spacing:1px;
        border-radius:10px;
      }
      
      .nav-btn{
        width:36px;
        height:36px;
        font-size:13px;
      }
      .play-pause{width:48px;height:48px;font-size:20px}
      .nav-controls{bottom:14px;gap:6px}
    }
    
    /* Landscape orientation adjustments */
    @media(max-height:600px) and (orientation:landscape){
      .header{top:10px}
      .header img{width:40px;height:40px}
      .header .title{font-size:16px}
      
      .typewriter{font-size:32px}
      .typewriter-container{min-height:70px}
      
      .intro-screen{
        height:85vh;
        max-height:450px;
      }
      
      .card .img{
        width:220px;
        height:300px;
      }
      
      .nav-controls{bottom:10px}
      .nav-btn{width:40px;height:40px}
      .play-pause{width:54px;height:54px}
      
      .center{padding:20px 12px}
    }
    
    /* Very small landscape phones */
    @media(max-height:450px) and (orientation:landscape){
      .header{display:none}
      
      .intro-screen{
        height:90vh;
        max-height:380px;
      }
      
      .card .img{
        width:180px;
        height:250px;
      }
      
      .meta .name{font-size:18px}
      .meta .pos{font-size:10px}
      
      .typewriter{font-size:24px}
      .typewriter-container{min-height:60px}
      
      .rewatch-btn{font-size:24px;padding:12px 24px}
    }
  </style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="bg"></div>
    <div class="overlay"></div>
    <div class="particles" id="particles"></div>

    <!-- Header with logo -->
    <div class="header" id="header">
      <img src="assets/barca.png" alt="FC Barcelona Logo">
      <div class="title">OFFICIAL LINEUP</div>
    </div>

    <div class="center">
      <!-- Typewriter text container -->
      <div class="typewriter-container" id="typewriterContainer">
        <div class="typewriter" id="typewriter"></div>
      </div>

      <!-- Player cards container -->
      <div class="intro-screen" id="intro">
        <div class="formation-img" id="formationWrap">
          <img id="formationImg" src="assets/formation-4-3-3.png" alt="4-3-3 formation">
        </div>

        <div class="card" id="cardTemplate" aria-hidden="true">
          <div class="img"><img src="" alt="player card"></div>
          <div class="meta">
            <div class="name"></div>
            <div class="pos"></div>
          </div>
        </div>
      </div>

      <!-- Rewatch button -->
      <button class="rewatch-btn" id="rewatchBtn">↻ REWATCH</button>
    </div>

    <!-- Navigation controls -->
    <div class="nav-controls" id="navControls">
      <button class="nav-btn" id="prevBtn">◀</button>
      <button class="nav-btn play-pause" id="playPauseBtn">⏸</button>
      <button class="nav-btn" id="nextBtn">▶</button>
    </div>

    <!-- Audio elements -->
    <audio id="bgMusic" src="assets/bg_music.mp3" loop preload="auto" autoplay muted></audio>
    <audio id="cheer" src="assets/short-cheer.mp3" preload="auto"></audio>
  </div>

  <script>
    const PLAYERS = [
      {file:'assets/players/ITOSHI.png', name:'FARHADUR RAHMAN', pos:'CF'},
      {file:'assets/players/TASIN.png', name:'TASIN AHMED', pos:'Captain - RW', captain:true},
      {file:'assets/players/SOBBO.png', name:'Deb Jyoti Arindom', pos:'LW'},
      {file:'assets/players/PRANTO.png', name:'PRANTO KAHAR', pos:'AM'},
      {file:'assets/players/SAHITYA.png', name:'SAHITYA SHARMA', pos:'CM'},
      {file:'assets/players/FAIAZ.png', name:'FAIAZ IBNE JAHIR', pos:'DM'},
      {file:'assets/players/SOJIB.png', name:'ABDUL ABAL SOJIB', pos:'LB'},
      {file:'assets/players/PROTIK.png', name:'PROTIK DATTA', pos:'CB'},
      {file:'assets/players/MUTTAKIN.png', name:'MUTTAKIN RAHMAN', pos:'CB'},
      {file:'assets/players/MUHIN.png', name:'SHAFAYET ISLAM', pos:'RB'},
      {file:'assets/players/NAHID.png', name:'NAHID ISLAM', pos:'GKCF'},
    ];

    const CARD_SHOW_MS = 7000;
    const FORMATION_SHOW_MS = 5000;

    const header = document.getElementById('header');
    const typewriterContainer = document.getElementById('typewriterContainer');
    const typewriter = document.getElementById('typewriter');
    const intro = document.getElementById('intro');
    const formationWrap = document.getElementById('formationWrap');
    const cardTemplate = document.getElementById('cardTemplate');
    const navControls = document.getElementById('navControls');
    const prevBtn = document.getElementById('prevBtn');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const nextBtn = document.getElementById('nextBtn');
    const rewatchBtn = document.getElementById('rewatchBtn');
    const particlesContainer = document.getElementById('particles');
    const bgMusic = document.getElementById('bgMusic');
    const cheer = document.getElementById('cheer');

    let currentIndex = 0;
    let isPlaying = true;
    let autoPlayTimeout = null;

    // Create floating particles
    function createParticles(){
      for(let i=0; i<30; i++){
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 8 + 's';
        particle.style.animationDuration = (Math.random() * 4 + 6) + 's';
        particlesContainer.appendChild(particle);
      }
    }
    createParticles();

    function sleep(ms){return new Promise(r=>setTimeout(r,ms));}

    // Typewriter effect
    function typeText(text, speed = 100){
      return new Promise(resolve => {
        typewriter.textContent = '';
        typewriter.style.animation = 'blink 0.7s step-end infinite';
        let i = 0;
        const interval = setInterval(() => {
          if(i < text.length){
            typewriter.textContent += text.charAt(i);
            i++;
          } else {
            clearInterval(interval);
            setTimeout(() => {
              typewriter.style.animation = 'none';
              resolve();
            }, 800);
          }
        }, speed);
      });
    }

    async function startSequence(){
      // Start background music
      bgMusic.volume = 0.4;
      bgMusic.play().catch(()=>{});

      // Show header
      header.classList.add('show');
      
      // First text: WELCOME TO FC BARCA
      typewriterContainer.classList.add('show');
      await typeText('WELCOME TO FC BARCA', 120);
      await sleep(2000);
      typewriterContainer.classList.remove('show');
      await sleep(800);

      // Second text: ARE YOU READY?
      typewriterContainer.classList.add('show');
      await typeText('ARE YOU READY?', 100);
      await sleep(2000);
      typewriterContainer.classList.remove('show');
      await sleep(800);

      // Third text: KICK OFF
      typewriterContainer.classList.add('show');
      await typeText('KICK OFF', 150);
      await sleep(1500);
      typewriterContainer.classList.remove('show');
      await sleep(500);

      // Show intro screen and navigation
      intro.classList.add('show');
      navControls.classList.add('show');

      // Start showing players
      currentIndex = 0;
      showCard(currentIndex);
      scheduleNextCard();
    }

    function showCard(index){
      if(index < 0 || index >= PLAYERS.length) return;

      const player = PLAYERS[index];
      const card = cardTemplate;
      const img = card.querySelector('img');
      
      card.querySelector('.name').textContent = player.name || '';
      card.querySelector('.pos').textContent = player.pos || '';
      img.src = player.file;
      img.alt = player.name + ' card';

      if(player.captain){
        card.classList.add('captain');
      } else {
        card.classList.remove('captain');
      }

      card.classList.add('show');
      formationWrap.classList.remove('show');

      // Play cheer sound (louder)
      cheer.currentTime = 0;
      cheer.volume = 0.6;
      cheer.play().catch(()=>{});

      // Update navigation buttons
      prevBtn.disabled = (index === 0);
      nextBtn.disabled = false;
    }

    function hideCard(){
      cardTemplate.classList.remove('show');
    }

    function scheduleNextCard(){
      if(!isPlaying) return;
      
      autoPlayTimeout = setTimeout(() => {
        if(currentIndex < PLAYERS.length - 1){
          currentIndex++;
          hideCard();
          setTimeout(() => {
            showCard(currentIndex);
            scheduleNextCard();
          }, 400);
        } else {
          // All cards shown, show formation
          hideCard();
          setTimeout(() => {
            showFormation();
          }, 400);
        }
      }, CARD_SHOW_MS);
    }

    async function showFormation(){
      formationWrap.classList.add('show');
      nextBtn.disabled = true;
      
      await sleep(FORMATION_SHOW_MS);
      
      // Show final scores
      intro.classList.remove('show');
      navControls.classList.remove('show');
      
      await sleep(500);
      
      typewriterContainer.classList.add('show');
      await typeText('BARCA - 7 | FAKE MADRID - 0', 100);
      await sleep(2500);
      typewriterContainer.classList.remove('show');
      
      await sleep(800);
      
      typewriterContainer.classList.add('show');
      await typeText('WE WIN', 120);
      await sleep(2000);
      typewriterContainer.classList.remove('show');
      
      await sleep(500);
      
      // Show rewatch button
      rewatchBtn.classList.add('show');
    }

    // Navigation controls
    prevBtn.addEventListener('click', () => {
      if(currentIndex > 0){
        clearTimeout(autoPlayTimeout);
        isPlaying = false;
        playPauseBtn.textContent = '▶';
        currentIndex--;
        hideCard();
        setTimeout(() => {
          showCard(currentIndex);
        }, 300);
      }
    });

    nextBtn.addEventListener('click', () => {
      if(currentIndex < PLAYERS.length - 1){
        clearTimeout(autoPlayTimeout);
        isPlaying = false;
        playPauseBtn.textContent = '▶';
        currentIndex++;
        hideCard();
        setTimeout(() => {
          showCard(currentIndex);
        }, 300);
      } else {
        // Jump to formation
        clearTimeout(autoPlayTimeout);
        isPlaying = false;
        playPauseBtn.textContent = '▶';
        hideCard();
        setTimeout(() => {
          showFormation();
        }, 300);
      }
    });

    playPauseBtn.addEventListener('click', () => {
      if(isPlaying){
        clearTimeout(autoPlayTimeout);
        isPlaying = false;
        playPauseBtn.textContent = '▶';
      } else {
        isPlaying = true;
        playPauseBtn.textContent = '⏸';
        scheduleNextCard();
      }
    });

    rewatchBtn.addEventListener('click', () => {
      location.reload();
    });

    // Preload images
    (function preload(){
      const urls = [formationImg.src, ...PLAYERS.map(p=>p.file)];
      urls.forEach(u=>{const i=new Image();i.src=u});
    })();

    // Start the sequence
    startSequence();
  </script>
</body>
</html>